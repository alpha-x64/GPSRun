#:kivy 2.1.0
#:import MapView kivy_garden

WindowManager:
    FirstW:
    Tutorial:
    GpsRun:
    GameOver:
    Win:


<FirstW>:
    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height

        Label:
            text: "Bienvenido a GpsRun \n ¿Quieres Jugar?"
            font_size: 32
            halign: "center"

        Button:
            text: "Ok"
            font_size: 32
            on_release: app.root.current = 'gpsrun'

        Button:
            text: "Instrucciones"
            on_release: app.root.current = 'tutorial'

<Tutorial>:
    BoxLayout:
        orientation: "vertical"

        Label:
            text: "Como Jugar:"
        Label:
            text: "-Tienes que adivinar el lugar en el mapa antes que se acabe el tiempo"
        Label:
            text: "-En el mapa tendrás que presionar el marcador/boton para elegir la ubicación"
        Label:
            text: "-Si aciertas ganaras puntos dependiendo de que tan rápido contestarás, y si te equivocas perderás puntos"
        Button:
            text: "Volver"
            on_release: app.root.current = 'first'

<GpsRun>:
    markup: True

    TabbedPanel:
        do_default_tab: False
        tab_width: root.width / 2
        
        TabbedPanelItem:
            text: "Desafío"

            BoxLayout:
                orientation: "vertical"

                Label: 
                    text: "Cerca del casino y empieza con P"
                Label:
                    text: root.cont + " segundos restantes"
                    

        TabbedPanelItem:
            text: "Mapa"

            BoxLayout:
                orientation: "vertical"

                #GpsRunMapView:
                MapView:
                    lat: -38.74777685568625
                    lon: -72.61683138418861
                    zoom: 18
                    on_zoom: 100 if self.zoom < 100 else self.zoom
                    #on_lat: self.add_player(), self.start_getting_objectives_in_fov()
                    #on_lon: self.add_player(), self.start_getting_objectives_in_fov()

                    MapMarkerPopup:
                        id: biblioteca
                        lat: -38.74838393048031
                        lon: -72.6175605760204
                        Button: 
                            size: root.width*0.1, root.height*0.1
                            text: "Biblioteca"
                            on_release: app.root.current = 'win'
                    MapMarkerPopup:
                        id: casino
                        lat: -38.746975571477094
                        lon: -72.61640320282768
                        Button: 
                            size: root.width*0.1, root.height*0.1
                            text: "Casino"
                            on_release: app.root.current = 'gameover'
                    MapMarkerPopup:
                        id: gimnasio
                        lat: -38.74780605166607
                        lon: -72.61801521044336
                        Button: 
                            size: root.width*0.1, root.height*0.1
                            text: "Gimnasio"
                            on_release: app.root.current = 'gameover'
                    MapMarkerPopup:
                        id: pabellon_d
                        lat: -38.74808217895947
                        lon: -72.61561999779056
                        Button: 
                            size: root.width*0.1, root.height*0.1
                            text: "Pabellon D"
                            on_release: app.root.current = 'gameover'
                    MapMarkerPopup:
                        id: pabellon_ra
                        lat: -38.74721613977589
                        lon: -72.61634687644846
                        Button: 
                            size: root.width*0.1, root.height*0.1
                            text: "Paellon RA"
                            on_release: app.root.current = 'gameover'
            
<GameOver>:
    BoxLayout:
        orientation: "vertical"

        Label:
            text: "Perdiste..."
        Button:
            text: "Volver al inicio"
            on_release: app.root.current = 'first'
<Win>:
    id: win
    BoxLayout:
        orientation:"vertical"

        Label: 
            text: "Lo lograste!\n Ganaste " + root.puntaje + " puntos"

        Button:
            text: "Reclamar puntaje"
            on_release:

        Button:
            text: "Volver al inicio"
            on_release: app.root.current = 'first'
    